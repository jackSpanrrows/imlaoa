<!--
author: 老A在Coding
date: 2020-11-20
title: [理论干货]MySQL逻辑架构
tags: MySQL
category: MySQL,MySQL逻辑架构
status: publish
summary: MySQL 逻辑架构
-->


[理论干货]MySQL逻辑架构


先来看看MySQL服务器逻辑架构图
![avatar](http://static.imlaoa.com/imlaoa/mysql_dry_goods_logic.png)
​   

       最上层的服务并不是MySQL独有的，大多数基于网络的客户端/服务器的工具或者服务都有类似的架构。比如连接处理、授权认证、安全等等。

      第二层架构是MySQL比较有意思的部分。大多数MySQL的核心服务功能都在这一层，包括查询解析、分析、优化、缓存以及所有的内置函数（例如：日期、时间、数学和加密函数），所有跨存储引擎的功能都在这一层实现：存储过程、触发器、视图等。

       第三层包含了存储引擎。存储引擎负责MySQL 中数据的存储和提取。不同存储引擎之间也不会相互通信，而只是简单地响应上层服务器的请求。


1、连接管理与安全性

        每个客户端连接都会在服务器进程中拥有一个线程，这个连接的查询只会在这个单独的线程中执行，该线程只能轮流在某个 CPU 核心或者 CPU 中运行。服务器会负责缓存线程，因此不需要为每一个新建的连接创建或者销毁线程。

注：MySQL5.5以及更新版本提供了一个API，支持线程池（Thread-Pooling）插件，可以使用池中少量的线程来服务大量的连接。


         当客户端（应用）连接到MySQL服务器时，服务器需要对其进行认证。认证基于用户名、原始主机信息和密码。如果使用了安全套接字（SSL）的方式连接，还可以使用X.509证书认证。一旦客户端连接成功，服务器会继续验证该客户端是否具有执行某个特定查询的权限（例如，是否允许客户端对 worl d数据库的 Country 表执行 SELECT 语句）。



2、优化与执行

        MySQL 会解析查询，并创建内部数据结构（解析数），然后对其进行各种优化，包括重写查询、决定表的读取顺序，以及选择合适的索引等。用户可以通过特殊的关键字提示（hint）优化器， 影响它的决策过程。也可以请求优化器解释（explain）优化过程的各个因素，使用户可以知道服务器是如何进行优化决策的，并提供一个参考基准。便于用户重构查询和 schema、修改相关配置，是应用尽可能高效运行。
        优化器并不关心表使用的是什么存储引擎，但存储引擎对于优化查询是有影响的。优化器会请求存储引擎提供容量或者某个具体操作的开销信息，以及表数据的统计信息等。例如，某些存储引擎的某种索引，可能对一些特定的查询有优化。

        对于 SELECT 语句，在解析查询之前，服务会先检查查询缓存（Query Cache）,如果能够在其中找到对应的查询，服务器就不必再执行查询解析、优化和执行的整个过程，而是直接返回查询缓存中的结果集。
        

上一篇 [Python安装模块那点破事](http://www.imlaoa.com/blog/py3-module-install.html)

下一篇 [[理论干货]MySQL锁粒度](http://www.imlaoa.com/blog/mysql-dry-goods-lock1.html)


